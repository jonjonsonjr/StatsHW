---
output: html_document
---

```{r}
library(ggplot2)
library(lattice)
```

Problems 2, 5, 12, 13, 14, 15, 17, 21

2. Consider the population {3, 6, 7, 9, 11, 14}. For samples of size 3 without replacement,
find (and plot) the sampling distribution of the minimum. What
is the mean of the sampling distribution? The statistic is an estimate of some
parameter—what is the value of that parameter?

```{r}
Population <- c(3, 6, 7, 9, 11, 14)
MIN <- apply(combn(Population, 3), 2, min)
MIN
mean(MIN)  # mean of the sampling distribution
# This statistic is an estimate of the population Min (3).
ggplot(data = data.frame(x = MIN), aes(x = x)) + geom_density() + theme_bw()
```

> **Prob 2 answer:** The mean of the sampling distribution is **`r mean(MIN)`** and the value of the parameter is **`r min(Population)`**.


5. Let X1,X2, . . . , Xn be a random sample from some distribution and suppose
Y = T (X1,X2, . . . , Xn) is a statistic. Suppose the sampling distribution of Y
has pdf f (y) = (3/8)y2 for 0 ≤ y ≤ 2. Find P(0 ≤ Y ≤ 1/5).

```{r}
f <- function(x){3*x^2/8}
integrate(f, 0, 2)$value # must be 1 for it to be a valid pdf
integrate(f, 0, 1/5)$value

curve(f)
abline(v=0)
abline(v=1/5)
abline(h=0)
```

> **Prob 5 answer:** The probability that 0 <= Y <= 1/5 is **`r integrate(f, 0, 1/5)$value`**.

12. A friend claims that she has drawn a random sample of size 30 from the exponential
distribution with λ = 1/10. The mean of her sample is 12.

(a) What is the expected value of a sample mean? <br>
(b) Run a simulation by drawing 1000 random samples, each of size 30, from
Exp(1/10) and then compute the mean. What proportion of the sample
means are as large as or larger than 12? <br>
(c) Is a mean of 12 unusual for a sample of size 30 from Exp(1/10)? <br>

```{r}
set.seed(13)
sims <- 1000
xbar <- numeric(sims)
for(i in 1:sims){
  xbar[i] <- mean(rexp(30, 1/10))
}
mean(xbar)
mean(xbar >= 12)
library(ggplot2)
ggplot(data = data.frame(x = xbar), aes(x = x)) + geom_density() + theme_bw() + stat_function(fun = dgamma, args = list(30*1, 30/10), lty = "dashed", color = "red")
```

> **Prob 12 answer:** The expected value of a sample mean is 1/λ, in this case **`r 1/(1/10)`**. The value of the sample mean is **`r mean(xbar)`**. The proportion of sample means as large as or larger than 12 is **`r mean(xbar >= 12)`**. Because **`r mean(xbar >= 12)`** is greater than 0.05, we cannot say that a mean of 12 is unusual for a sample of size 30 from Exp(1/10).

13. Let X1,X2, . . .,X10
i.∼i.d. N(20, 82) and Y1, Y2, . . ., Y15
i.∼i.d. N(16, 72). Let
W = Xhat + Yhat.

(a) Give the exact sampling distribution of W.
(b) Simulate the sampling distribution in R and plot your results. Check that
the simulated mean and standard error are close to the theoretical mean and
the standard error.
(c) Use your simulation to find P(W < 40). Calculate an exact answer and
compare.

```{r}
set.seed(13)
sims <- 10000
xbar <- numeric(sims)
ybar <- numeric(sims)
for(i in 1:sims){
  xbar[i] <- mean(rnorm(10, 20, 8))
  ybar[i] <- mean(rnorm(15, 16, 7))
}
W <- xbar + ybar
hist(W)
mean(W)  # close to 36
sd(W)    # close to 3.11
mean(W < 40)
foo <- sqrt(8^2/10 + 7^2/15)
# Exact answer
pnorm(40, 36, foo)

```

> **Prob 13(a) answer:** The exact sampling distribution of W = **$\hat{X}$ + $\hat{Y}$ ~ N(`r mean(W)`,`r sd(W)^2`)**.

> **Prob 13(b) answer:** 

> **Prob 13(c) answer:** Using our simulation to find P(W < 40) to calculate the exact answer yielded **`r pnorm(40, 36, foo)`**.

14. Let X1,X2, . . . , X9
i.∼i.d. N(7, 32) and Y1, Y2, . . . , Y12
i.∼i.d. N(10, 52). LetW = Xhat - Yhat.
(a) Give the exact sampling distribution of W.
(b) Simulate the sampling distribution of W in R and plot your results (adapt
code from the previous exercise). Check that the simulated mean and the
standard error are close to the theoretical mean and the standard error.
(c) Use your simulation to find P(W < −1.5). Calculate an exact answer and
compare.

# Use pnorm and what we found in 14.a to find an exact answer

15. Let X_1, X_2, ..., X_n be a random sample from N(0, 1). Let W = X_1^2 + X_2^2 + ... + x_n^2

Describe the sampling distribution of W by running a simulation,
using n = 2. What is the mean and variance of the sampling distribution of W?
Repeat using n = 4, n = 5. What observations or conjectures do you have for
general n?


```{r}
set.seed(13)
sims <- 10000
WE2 <- numeric(sims)
WE4 <- numeric(sims)
WE5 <- numeric(sims)

for (i in 1:sims) {
  WE2[i] <- sum(rnorm(2)^2)
  WE4[i] <- sum(rnorm(4)^2)
  WE5[i] <- sum(rnorm(5)^2)
}

mean(WE2)
mean(WE4)
mean(WE5)
var(WE2)
var(WE4)
var(WE5)
```

> **Prob 15 answer:** The mean of W is approximately n. The variance of W is approximately 2n.

17. Let X1,X2, . . . , X20 i.∼i.d. Exp(2). Let X = sum [1,20] X_i.

(a) Simulate the sampling distribution of X in R.
(b) From your simulation, find E [X] and Var[X].
(c) From your simulation, find P(X ≤ 10).

```{r}
set.seed(13)
sims <- 10000
WE <- numeric(sims)
for(i in 1:sims){
  WE[i] <- sum(rexp(20, 2))
}
mean(WE)
var(WE)
mean(WE <= 10)
```

> **Prob 17b answer:** The expected value for X is **`r mean(WE)`** and the variance of X is **`r var(WE)`**.

> **Prob 17c answer:** The probability that X <= 10 is **`r mean(WE <= 10)`**.

21. Let X1,X2 i.∼i.d. F with corresponding pdf f (x) = 2/x2, 1 ≤ x ≤ 2.
(a) Find the pdf of Xmax.
(b) Find the expected value of Xmax.

